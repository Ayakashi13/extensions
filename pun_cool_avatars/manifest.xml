<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE extension SYSTEM "ext-1.0.dtd">

<!--
/**
 * Cool avatars.
 *
 * @copyright (C) 2008-2009 PunBB
 * @license http://www.gnu.org/licenses/gpl.html GPL version 2 or higher
 * @package pun_cool_avatars
 */
-->

<extension engine="1.0">
	<id>pun_cool_avatars</id>
	<title>Cool avatars</title>
	<version>0.1</version>
	<description>The extension allow to use service http://avatar.pho.to/.</description>
	<author>PunBB Development Team</author>
	<minversion>1.3</minversion>
	<maxtestedon>1.3.4</maxtestedon>
	<uninstall><![CDATA[
		if (file_exists(FORUM_CACHE_DIR.'cache_pho_to_templates.php'))
			unlink(FORUM_CACHE_DIR.'cache_pho_to_templates.php');
	]]></uninstall>

	<hooks>
		<hook id="co_modify_url_scheme"><![CDATA[
$forum_url['pho.to_queue'] = 'http://ope-api.pho.to/queued.php?key=$1&image_url=$2&image_limit=$3';
$forum_url['pho.to_get-result'] = 'http://ope-api.pho.to/get-result.php?request_id=$1&remove_limit=visit_page';
$forum_url['pho.to_AET_templates'] = 'http://ope-api.pho.to/service.php?method=get_templates&type=AET';
$forum_url['pho.to_FET_templates'] = 'http://ope-api.pho.to/service.php?method=get_templates&type=FET';
		]]></hook>
		<hook id="pf_start"><![CDATA[
define('FREE_KEY', '3CCREZBSFGLPUYAXT7RJL6KEF6EB');
define('IMAGE_LIMIT', 'watermark');
		]]></hook>
		<hook id="pf_change_details_avatar_pre_header_load"><![CDATA[
include $ext_info['path'].'/functions.php';
if (file_exists(FORUM_CACHE_DIR.'cache_pho_to_templates.php'))
	include FORUM_CACHE_DIR.'cache_pho_to_templates.php';
if (!defined('PHO.TO_TEMPLATES_LOADED') || $pho_to_templates['cached'] < (time() - 43200))
{
	generate_templates_cache();
	require FORUM_CACHE_DIR.'cache_pho_to_templates.php';
}
		]]></hook>
		<hook id="pf_change_details_avatar_end"><![CDATA[
include $ext_info['path'].'/pho.to_block.php';
		]]></hook>
	</hooks>
</extension>